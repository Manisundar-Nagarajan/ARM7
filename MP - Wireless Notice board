#include<LPC21XX.H>
#include "LCD_header.h"
#define SW 14
void UART_config(void);
void UART_Tx(unsigned char);
unsigned char UART_Rx(void);
void UART_Str(unsigned char *);

int main()
	{
	  unsigned char s[5];
		unsigned char n[30];
		unsigned char i=0,ch;
		static int j=0;
		LCD_INIT();
		LCD_CMD(0x80);
		LCD_STRING("WIRELESS NOTICE");
	  PINSEL0|=0x5;
	  UART_config();
		
	  while(1)
	  {
				ch=UART_Rx();
		if(ch>='0' && ch<='9')
		{
			s[i++]=ch;
		}
		else if((ch>='A' && ch<='Z') || (ch>='a' && ch<='z'))
			n[i++]=ch;
		
		else if(ch=='\r'||ch=='\n')
		{ 	
			if(i<=5)
				s[i]='\0';
			
		    n[i]='\0';
			i=0;	
		}
		if(j<1)
		{
			LCD_CMD(0xc0);
		  LCD_STRING(s);
			j++;
		}
		  LCD_CMD(0xc3);
		  LCD_STRING(n);
		if(((IOPIN0>>SW)&1)==0)
		{
			while(((IOPIN0>>SW)&1)==0);
			if(s[1]=='9')
			{
				s[0]=s[0]+48;
				s[1]=0;
			}
			else if(s[0]=='9')
			{
				s[0]=1;
				s[1]=0;
				s[2]='\0';
			}
			else
				s[1]=s[1]+48;
		}
				
			UART_Str(s);
		  LCD_CMD(0xc0);
		  LCD_STRING(s);
		
		}
	}
	
	void UART_config(void)
	{		
				U0LCR=0x83;
				U0DLL=97;
				U0DLM=0;
				U0LCR=0x03;
	}
	
	void UART_Tx(unsigned char ch)
	{
		U0THR=ch;
		while(((U0LSR>>5)&1)==0);
	}
	
	unsigned char UART_Rx(void)
	{
		while((U0LSR&1)==0);
		return U0RBR;
	}
	
	void UART_Str(unsigned char *s)
	{
	while(*s)
	UART_Tx(*s++);
	}
	


/* LCD HEADER*/

#include<LPC21XX.H>
#define LCD 0xf
#define RS 1<<7
#define E 1<<8
void LCD_INIT(void);
void LCD_CMD(unsigned char);
void LCD_DATA(unsigned char);
void LCD_STRING(unsigned char *);
void delay_ms(unsigned int ms);
void LCD_INIT(void)
	{
	IODIR0=LCD|RS|E;
	LCD_CMD(0x01);
	LCD_CMD(0x02);
	LCD_CMD(0x0c);
	LCD_CMD(0x38);
	}
	void LCD_CMD(unsigned char CMD)
	{
	IOCLR0=(LCD<<3);
	IOSET0=CMD;
	IOCLR0=RS;
	IOSET0=E;
	delay_ms(250);
	IOCLR0=E;
	}
	void LCD_DATA(unsigned char DATA)
	{
	IOCLR0=(LCD<<3);
	IOSET0=DATA;
	IOSET0=RS;
	IOSET0=E;
	delay_ms(250);
	IOCLR0=E;
	}
	void delay_ms(unsigned int ms)
	{
	T0PR=15000-1;
	T0TCR=0x01;
	while(T0TC<ms);
	T0TCR=0x03;
	T0TCR=0x00;
	}
	void LCD_STRING(unsigned char *s)
	{
		while(*s)
	LCD_DATA(*s++);
	}
	
